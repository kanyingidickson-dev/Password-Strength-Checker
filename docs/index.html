<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Password Toolkit</title>
    <link rel="stylesheet" href="assets/styles.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="container">
        <div class="brand">
          <div class="brand__title">Password Toolkit</div>
          <div class="brand__subtitle">Strength checks, generator, and offline crypto tools.</div>
        </div>
        <nav class="tabs" aria-label="Tools">
          <button class="tab is-active" data-tab="analyze" type="button">Strength</button>
          <button class="tab" data-tab="generate" type="button">Generator</button>
          <button class="tab" data-tab="crypto" type="button">Crypto</button>
        </nav>
      </div>
    </header>

    <main class="container">
      <section class="panel is-active" id="panel-analyze" aria-label="Password strength analysis">
        <div class="grid">
          <div class="card">
            <h2>Check a password</h2>
            <div class="field">
              <label for="pwd">Password</label>
              <div class="input-row">
                <input id="pwd" type="password" autocomplete="off" spellcheck="false" />
                <button id="toggle-visibility" class="btn btn-secondary" type="button">Show</button>
              </div>
              <div class="hint">Tip: use the generator tab if you need something strong quickly.</div>
            </div>

            <details class="details">
              <summary class="details__summary">Advanced analysis settings</summary>

              <div class="field">
                <label for="policy">Policy profile</label>
                <select id="policy">
                  <option value="balanced" selected>Balanced</option>
                  <option value="nist">NIST-style</option>
                  <option value="strict">Strict</option>
                </select>
              </div>

              <div class="field">
                <label>Checks</label>
                <label><input id="toggle-patterns" type="checkbox" checked /> Pattern checks</label>
                <label><input id="toggle-dictionary" type="checkbox" checked /> Dictionary word checks</label>
                <label><input id="toggle-reuse" type="checkbox" checked /> Local reuse check</label>
              </div>

              <div class="field">
                <label for="wordlist">Custom wordlist (optional)</label>
                <input id="wordlist" type="file" accept=".txt" />
                <div class="hint">If provided, it’s used for on-device dictionary checks. Your file never leaves the browser.</div>
              </div>

              <div class="field">
                <label for="weights-json">Custom scoring weights (optional JSON)</label>
                <textarea id="weights-json" rows="4" spellcheck="false" placeholder='{"commonPasswordPenalty": 60, "sequencePenalty": 20}'></textarea>
                <div class="hint">Leave empty to use the selected policy defaults.</div>
              </div>
            </details>

            <div class="field">
              <label for="pepper">Local reuse check pepper (optional)</label>
              <input id="pepper" type="password" autocomplete="off" spellcheck="false" />
              <div class="hint">If set, the app can detect reuse on this device without storing your password.</div>
            </div>

            <div class="row">
              <button id="analyze" class="btn" type="button">Analyze</button>
              <button id="clear-history" class="btn btn-secondary" type="button">Clear local history</button>
              <button id="export-json" class="btn btn-secondary" type="button">Export JSON</button>
            </div>

            <div class="divider"></div>

            <div class="metric">
              <div class="metric__label">Score</div>
              <div class="metric__value">
                <span id="score">—</span><span class="muted">/100</span>
              </div>
              <div class="meter" aria-hidden="true">
                <div id="meter-fill" class="meter__fill"></div>
              </div>
              <div class="pill" id="label">—</div>
            </div>

            <div class="mini-grid">
              <div class="mini">
                <div class="mini__k">Entropy</div>
                <div class="mini__v"><span id="entropy">—</span><span class="muted"> bits</span></div>
              </div>
              <div class="mini">
                <div class="mini__k">Shannon</div>
                <div class="mini__v"><span id="shannon">—</span><span class="muted"> bits</span></div>
              </div>
              <div class="mini">
                <div class="mini__k">Reuse</div>
                <div class="mini__v" id="reuse">—</div>
              </div>
            </div>
          </div>

          <div class="card">
            <h2>What the tool noticed</h2>
            <ul id="reasons" class="list"></ul>
            <div class="note">
              This is a practical scoring model. It’s not a proof of security—just a fast way to spot risky choices.
            </div>
          </div>
        </div>
      </section>

      <section class="panel" id="panel-generate" aria-label="Password generator">
        <div class="grid">
          <div class="card">
            <h2>Generate a strong password</h2>
            <div class="form-grid">
              <div class="field">
                <label for="gen-length">Length</label>
                <input id="gen-length" type="number" min="8" max="128" value="20" />
              </div>
              <div class="field">
                <label><input id="gen-lower" type="checkbox" checked /> Lowercase</label>
                <label><input id="gen-upper" type="checkbox" checked /> Uppercase</label>
                <label><input id="gen-digits" type="checkbox" checked /> Digits</label>
                <label><input id="gen-symbols" type="checkbox" checked /> Symbols</label>
                <label><input id="gen-avoid-ambiguous" type="checkbox" checked /> Avoid ambiguous</label>
                <label><input id="gen-require-each" type="checkbox" checked /> Require each selected set</label>
              </div>
            </div>
            <div class="row">
              <button id="generate" class="btn" type="button">Generate</button>
              <button id="copy-generated" class="btn btn-secondary" type="button">Copy</button>
            </div>
            <div class="output" id="generated" aria-live="polite">—</div>
          </div>

          <div class="card">
            <h2>Quick check</h2>
            <div class="hint">Run the strength checker on the generated password without putting it in your clipboard.</div>
            <button id="analyze-generated" class="btn btn-secondary" type="button">Analyze generated password</button>
          </div>
        </div>
      </section>

      <section class="panel" id="panel-crypto" aria-label="Crypto tools">
        <div class="grid">
          <div class="card">
            <h2>Hash / HMAC</h2>
            <div class="field">
              <label for="crypto-text">Text</label>
              <textarea id="crypto-text" rows="5" spellcheck="false"></textarea>
            </div>
            <div class="form-grid">
              <div class="field">
                <label for="hash-algo">Hash algorithm</label>
                <select id="hash-algo">
                  <option value="SHA-256" selected>SHA-256</option>
                  <option value="SHA-384">SHA-384</option>
                  <option value="SHA-512">SHA-512</option>
                  <option value="SHA-1">SHA-1</option>
                </select>
              </div>
              <div class="field">
                <label for="hash-format">Output</label>
                <select id="hash-format">
                  <option value="hex" selected>Hex</option>
                  <option value="base64">Base64</option>
                </select>
              </div>
            </div>
            <div class="field">
              <label for="hmac-key">HMAC key (optional)</label>
              <input id="hmac-key" type="password" autocomplete="off" spellcheck="false" />
            </div>
            <div class="row">
              <button id="do-hash" class="btn" type="button">Compute</button>
              <button id="copy-hash" class="btn btn-secondary" type="button">Copy</button>
            </div>
            <div class="output" id="hash-out">—</div>

            <div class="field">
              <label for="hash-expected">Expected output (optional)</label>
              <input id="hash-expected" type="text" spellcheck="false" />
              <div class="hint">This verifies whether the computed value matches what you expect.</div>
            </div>
            <div class="pill" id="hash-match">—</div>
          </div>

          <div class="card">
            <h2>PBKDF2</h2>
            <div class="field">
              <label for="kdf-password">Password</label>
              <input id="kdf-password" type="password" autocomplete="off" spellcheck="false" />
            </div>
            <div class="form-grid">
              <div class="field">
                <label for="kdf-salt">Salt</label>
                <input id="kdf-salt" type="text" spellcheck="false" value="salt" />
              </div>
              <div class="field">
                <label for="kdf-iter">Iterations</label>
                <input id="kdf-iter" type="number" min="1000" max="2000000" value="200000" />
              </div>
              <div class="field">
                <label for="kdf-len">Key length (bytes)</label>
                <input id="kdf-len" type="number" min="16" max="64" value="32" />
              </div>
            </div>
            <div class="row">
              <button id="do-kdf" class="btn" type="button">Derive key</button>
              <button id="copy-kdf" class="btn btn-secondary" type="button">Copy</button>
            </div>
            <div class="output" id="kdf-out">—</div>
          </div>

          <div class="card">
            <h2>AES-GCM encrypt / decrypt</h2>
            <div class="field">
              <label for="aes-key">Key (text)</label>
              <input id="aes-key" type="password" autocomplete="off" spellcheck="false" />
            </div>
            <div class="field">
              <label for="aes-plain">Plaintext</label>
              <textarea id="aes-plain" rows="4" spellcheck="false"></textarea>
            </div>
            <div class="row">
              <button id="do-encrypt" class="btn" type="button">Encrypt</button>
              <button id="copy-cipher" class="btn btn-secondary" type="button">Copy</button>
            </div>
            <div class="output" id="aes-cipher">—</div>

            <div class="divider"></div>

            <div class="field">
              <label for="aes-input">Ciphertext (Base64)</label>
              <textarea id="aes-input" rows="4" spellcheck="false"></textarea>
            </div>
            <div class="row">
              <button id="do-decrypt" class="btn btn-secondary" type="button">Decrypt</button>
            </div>
            <div class="output" id="aes-plain-out">—</div>
          </div>

          <div class="card">
            <h2>Base64</h2>
            <div class="field">
              <label for="b64-in">Text</label>
              <textarea id="b64-in" rows="4" spellcheck="false"></textarea>
            </div>
            <div class="row">
              <button id="b64-encode" class="btn" type="button">Encode</button>
              <button id="b64-decode" class="btn btn-secondary" type="button">Decode</button>
            </div>
            <div class="output" id="b64-out">—</div>
          </div>
        </div>
      </section>

      <footer class="footer">
        <div class="muted">
          Everything runs locally in your browser. No database, no tracking.
        </div>
      </footer>
    </main>

    <script type="module" src="assets/app.js"></script>
  </body>
</html>
